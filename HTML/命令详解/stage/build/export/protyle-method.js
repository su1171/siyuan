!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Protyle=t():e.Protyle=t()}(self,(()=>(()=>{"use strict";var e={378:(e,t,n)=>{n.r(t)},450:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;class n{}t.Constants=n,n.SIYUAN_VERSION="2.2.0",n.NODE_ENV="production",n.SIYUAN_APPID=Math.random().toString(36).substring(8),n.ASSETS_ADDRESS="https://assets.b3logfile.com/siyuan/",n.PROTYLE_CDN="/stage/protyle",n.UPLOAD_ADDRESS="/upload",n.SIYUAN_DROP_FILE="application/siyuan-file",n.SIYUAN_DROP_TAB="application/siyuan-tab",n.SIYUAN_DROP_EDITOR="application/siyuan-editor",n.SIYUAN_CONFIG_THEME="siyuan-config-theme",n.SIYUAN_CONFIG_CLOSE="siyuan-config-close",n.SIYUAN_CONFIG_TRAY="siyuan-config-tray",n.SIYUAN_CONFIG_CLOSETRAY="siyuan-config-closetray",n.SIYUAN_QUIT="siyuan-quit",n.SIYUAN_HOTKEY="siyuan-hotkey",n.SIYUAN_INIT="siyuan-init",n.SIYUAN_OPENURL="siyuan-openurl",n.SIYUAN_SAVE_CLOSE="siyuan-save-close",n.SIYUAN_EXPORT_PDF="siyuan-export-pdf",n.SIYUAN_EXPORT_CLOSE="siyuan-export-close",n.SIZE_TOOLBAR_HEIGHT=30,n.SIZE_GET=36,n.SIZE_GET_MAX=102400,n.SIZE_UNDO=64,n.SIZE_TITLE=512,n.SIZE_EDITOR_WIDTH=760,n.CB_MOUNT_HELP="cb-mount-help",n.CB_MOUNT_REMOVE="cb-mount-remove",n.CB_GET_APPEND="cb-get-append",n.CB_GET_BEFORE="cb-get-before",n.CB_GET_UNCHANGEID="cb-get-unchangeid",n.CB_GET_HL="cb-get-hl",n.CB_GET_FOCUS="cb-get-focus",n.CB_GET_FOCUSFIRST="cb-get-focusfirst",n.CB_GET_SETID="cb-get-setid",n.CB_GET_ALL="cb-get-all",n.CB_GET_UNUNDO="cb-get-unundo",n.CB_GET_SCROLL="cb-get-scroll",n.CB_GET_CONTEXT="cb-get-context",n.CB_GET_HTML="cb-get-html",n.CB_GET_HISTORY="cb-get-history",n.LOCAL_SEARCHEDATA="local-searchedata",n.LOCAL_SEARCHETABDATA="local-searchetabdata",n.LOCAL_DOCINFO="local-docinfo",n.LOCAL_DAILYNOTEID="local-dailynoteid",n.LOCAL_HISTORYNOTEID="local-historynoteid",n.LOCAL_CODELANG="local-codelang",n.LOCAL_FONTSTYLES="local-fontstyles",n.LOCAL_EXPORTPDF="local-exportpdf",n.LOCAL_EXPORTWORD="local-exportword",n.LOCAL_BAZAAR="local-bazaar",n.TIMEOUT_DBLCLICK=190,n.TIMEOUT_SEARCH=300,n.TIMEOUT_INPUT=256,n.TIMEOUT_BLOCKLOAD=300,n.HELP_PATH={zh_CN:"20210808180117-czj9bvb",zh_CHT:"20211226090932-5lcq56f",en_US:"20210808180117-6v0mkxr",fr_FR:"20210808180117-6v0mkxr"},n.HELP_START_PATH={zh_CN:"20200812220555-lj3enxa",zh_CHT:"20211226115423-d5z1joq",en_US:"20200923234011-ieuun1p",fr_FR:"20200923234011-ieuun1p"},n.SIYUAN_KEYMAP={general:{syncNow:{default:"F9",custom:"F9"},enterBack:{default:"⌥←",custom:"⌥←"},enter:{default:"⌥→",custom:"⌥→"},goForward:{default:"⌘]",custom:"⌘]"},goBack:{default:"⌘[",custom:"⌘["},newFile:{default:"⌘N",custom:"⌘N"},search:{default:"⌘F",custom:"⌘F"},globalSearch:{default:"⌘P",custom:"⌘P"},stickSearch:{default:"⇧⌘F",custom:"⇧⌘F"},replace:{default:"⌘R",custom:"⌘R"},closeTab:{default:"⌘W",custom:"⌘W"},fileTree:{default:"⌥1",custom:"⌥1"},outline:{default:"⌥2",custom:"⌥2"},bookmark:{default:"⌥3",custom:"⌥3"},tag:{default:"⌥4",custom:"⌥4"},dailyNote:{default:"⌥5",custom:"⌥5"},inbox:{default:"⌥6",custom:"⌥6"},backlinks:{default:"⌥7",custom:"⌥7"},graphView:{default:"⌥8",custom:"⌥8"},globalGraph:{default:"⌥9",custom:"⌥9"},config:{default:"⌥P",custom:"⌥P"},history:{default:"⌥H",custom:"⌥H"},toggleWin:{default:"⌥M",custom:"⌥M"},lockScreen:{default:"⌥N",custom:"⌥N"},move:{default:"",custom:""},selectOpen1:{default:"",custom:""}},editor:{general:{copyPlainText:{default:"",custom:""},copyID:{default:"",custom:""},netImg2LocalAsset:{default:"",custom:""},hLayout:{default:"",custom:""},vLayout:{default:"",custom:""},refPopover:{default:"",custom:""},expand:{default:"⌘↓",custom:"⌘↓"},collapse:{default:"⌘↑",custom:"⌘↑"},insertBottom:{default:"⌥⌘.",custom:"⌥⌘."},refTab:{default:"⇧⌘>",custom:"⇧⌘>"},openBy:{default:"⌘.",custom:"⌘."},insertRight:{default:"⌥.",custom:"⌥."},attr:{default:"⌥⌘A",custom:"⌥⌘A"},refresh:{default:"F5",custom:"F5"},copyBlockRef:{default:"⇧⌘C",custom:"⇧⌘C"},copyProtocol:{default:"⇧⌘H",custom:"⇧⌘H"},copyBlockEmbed:{default:"⇧⌘E",custom:"⇧⌘E"},copyHPath:{default:"⇧⌘P",custom:"⇧⌘P"},pasteAsPlainText:{default:"⇧⌘V",custom:"⇧⌘V"},undo:{default:"⌘Z",custom:"⌘Z"},redo:{default:"⌘Y",custom:"⌘Y"},rename:{default:"F2",custom:"F2"},newNameFile:{default:"F3",custom:"F3"},newContentFile:{default:"F4",custom:"F4"},showInFolder:{default:"⌥A",custom:"⌥A"},outline:{default:"⌥O",custom:"⌥O"},backlinks:{default:"⌥B",custom:"⌥B"},graphView:{default:"⌥G",custom:"⌥G"},fullscreen:{default:"⌥Y",custom:"⌥Y"},alignLeft:{default:"⌥L",custom:"⌥L"},alignCenter:{default:"⌥C",custom:"⌥C"},alignRight:{default:"⌥R",custom:"⌥R"},wysiwyg:{default:"⌥⌘7",custom:"⌥⌘7"},preview:{default:"⌥⌘9",custom:"⌥⌘9"},insertBefore:{default:"⇧⌘B",custom:"⇧⌘B"},insertAfter:{default:"⇧⌘A",custom:"⇧⌘A"},jumpToParentNext:{default:"⇧⌘N",custom:"⇧⌘N"},moveToUp:{default:"⇧⌘↑",custom:"⇧⌘↑"},moveToDown:{default:"⇧⌘↓",custom:"⇧⌘↓"}},insert:{font:{default:"⌥⌘X",custom:"⌥⌘X"},lastUsed:{default:"⌥X",custom:"⌥X"},blockRef:{default:"⌥[",custom:"⌥["},kbd:{default:"⌘'",custom:"⌘'"},sup:{default:"⌘H",custom:"⌘H"},sub:{default:"⌘J",custom:"⌘J"},bold:{default:"⌘B",custom:"⌘B"},"inline-math":{default:"⌘M",custom:"⌘M"},memo:{default:"⌥⌘M",custom:"⌥⌘M"},underline:{default:"⌘U",custom:"⌘U"},italic:{default:"⌘I",custom:"⌘I"},mark:{default:"⌘E",custom:"⌘E"},tag:{default:"⌘T",custom:"⌘T"},strike:{default:"⌘D",custom:"⌘D"},"inline-code":{default:"⌘G",custom:"⌘G"},link:{default:"⌘K",custom:"⌘K"},check:{default:"⌘L",custom:"⌘L"},table:{default:"⌘O",custom:"⌘O"},code:{default:"⇧⌘K",custom:"⇧⌘K"},clearFontStyle:{default:"⌘\\",custom:"⌘\\"}},heading:{paragraph:{default:"⌥⌘0",custom:"⌥⌘0"},heading1:{default:"⌥⌘1",custom:"⌥⌘1"},heading2:{default:"⌥⌘2",custom:"⌥⌘2"},heading3:{default:"⌥⌘3",custom:"⌥⌘3"},heading4:{default:"⌥⌘4",custom:"⌥⌘4"},heading5:{default:"⌥⌘5",custom:"⌥⌘5"},heading6:{default:"⌥⌘6",custom:"⌥⌘6"}},list:{indent:{default:"⇥",custom:"⇥"},outdent:{default:"⇧⇥",custom:"⇧⇥"},checkToggle:{default:"⌘↩",custom:"⌘↩"}},table:{insertRowAbove:{default:"⇧⌘T",custom:"⇧⌘T"},insertRowBelow:{default:"⇧⌘D",custom:"⇧⌘D"},insertColumnLeft:{default:"⇧⌘L",custom:"⇧⌘L"},insertColumnRight:{default:"⇧⌘R",custom:"⇧⌘R"},moveToUp:{default:"⌥⌘T",custom:"⌥⌘T"},moveToDown:{default:"⌥⌘B",custom:"⌥⌘B"},moveToLeft:{default:"⌥⌘L",custom:"⌥⌘L"},moveToRight:{default:"⌥⌘R",custom:"⌥⌘R"},"delete-row":{default:"⌘-",custom:"⌘-"},"delete-column":{default:"⇧⌘_",custom:"⇧⌘_"}}}},n.SIYUAN_EMPTY_LAYOUT={hideDock:!1,layout:{direction:"tb",size:"0px",type:"normal",instance:"Layout",children:[{direction:"lr",size:"0px",type:"top",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"lr",children:[]}]},{direction:"lr",resize:"tb",size:"auto",type:"normal",instance:"Layout",children:[{direction:"tb",size:"0px",type:"left",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"tb",children:[]}]},{direction:"lr",resize:"lr",size:"auto",type:"center",instance:"Layout",children:[{instance:"Wnd",children:[{instance:"Tab",children:[]}]}]},{direction:"tb",size:"0px",resize:"lr",type:"right",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"tb",children:[]}]}]},{direction:"lr",size:"0px",resize:"tb",type:"bottom",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"lr",children:[]}]}]},top:[],bottom:[],left:[[{type:"file",size:{width:240,height:0},show:!0,icon:"iconFiles",hotkeyLangId:"fileTree"},{type:"outline",size:{width:240,height:0},show:!1,icon:"iconAlignCenter",hotkeyLangId:"outline"},{type:"inbox",size:{width:252,height:0},show:!1,icon:"iconInbox",hotkeyLangId:"inbox"}],[{type:"bookmark",size:{width:240,height:0},show:!1,icon:"iconBookmark",hotkeyLangId:"bookmark"},{type:"tag",size:{width:240,height:0},show:!1,icon:"iconTags",hotkeyLangId:"tag"}]],right:[[{type:"graph",size:{width:360,height:0},show:!1,icon:"iconGraph",hotkeyLangId:"graphView"},{type:"globalGraph",size:{width:360,height:0},show:!1,icon:"iconGlobalGraph",hotkeyLangId:"globalGraph"}],[{type:"backlink",size:{width:360,height:0},show:!1,icon:"iconLink",hotkeyLangId:"backlinks"}]]},n.SIYUAN_IMAGE_VIP='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">\n<path fill="#ffd00f" d="M2.288 12.643l23.487 12.853c0.286 0.153 0.477 0.45 0.477 0.791 0 0.082-0.011 0.161-0.032 0.237l0.001-0.006c-0.119 0.395-0.479 0.678-0.905 0.678-0.004 0-0.009-0-0.013-0h-19.439c-0.958 0-1.766-0.684-1.885-1.595l-1.691-12.956z"></path>\n<path fill="#ffd00f" d="M29.676 12.643l-1.691 12.957c-0.119 0.911-0.927 1.594-1.884 1.594h-19.442c-0.004 0-0.009 0-0.013 0-0.425 0-0.785-0.281-0.903-0.668l-0.002-0.007c-0.019-0.070-0.031-0.15-0.031-0.232 0-0.341 0.191-0.638 0.472-0.788l0.005-0.002 23.487-12.853z"></path>\n<path fill="#ffe668" d="M15.413 8.369l10.394 15.921c0.378 0.579 0.407 1.317 0.076 1.924-0.328 0.591-0.948 0.985-1.66 0.985-0 0-0.001 0-0.001 0h-17.617c-0.694 0-1.331-0.378-1.661-0.985-0.144-0.26-0.229-0.569-0.229-0.899 0-0.382 0.114-0.736 0.31-1.033l-0.004 0.007 10.394-15.921z"></path>\n<path fill="#ffdd4e" d="M15.396 8.403l11.659 15.921c0.401 0.579 0.432 1.317 0.081 1.924-0.361 0.594-1.005 0.985-1.741 0.985-0.008 0-0.017-0-0.025-0h-9.344l-0.63-18.83z"></path>\n<path fill="#ffd00f" d="M13.868 6.478c0 0.946 0.767 1.712 1.712 1.712s1.712-0.767 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0zM28.577 10.818c0 0.945 0.766 1.712 1.712 1.712s1.712-0.766 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0zM0 10.822c0 0.945 0.766 1.712 1.712 1.712s1.712-0.766 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0z"></path>\n</svg>',n.SIYUAN_IMAGE_FILE="1f4c4",n.SIYUAN_IMAGE_NOTE="1f5c3",n.SIYUAN_IMAGE_FOLDER="1f4d1",n.SIYUAN_ASSETS_IMAGE=[".apng",".ico",".cur",".jpg",".jpe",".jpeg",".jfif",".pjp",".pjpeg",".png",".gif",".webp",".bmp",".svg"],n.SIYUAN_ASSETS_AUDIO=[".mp3",".wav",".ogg",".m4a"],n.SIYUAN_ASSETS_VIDEO=[".mov",".weba",".mkv",".mp4",".webm"],n.SIYUAN_ASSETS_EXTS=[".pdf"].concat(n.SIYUAN_ASSETS_IMAGE).concat(n.SIYUAN_ASSETS_AUDIO).concat(n.SIYUAN_ASSETS_VIDEO),n.SIYUAN_CONFIG_APPEARANCE_DARK_CODE=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256"],n.SIYUAN_CONFIG_APPEARANCE_LIGHT_CODE=["ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],n.ZWSP="​",n.INLINE_TYPE=["block-ref","kbd","text","file-annotation-ref","a","strong","em","u","s","mark","sup","sub","tag","code","inline-math","inline-memo"],n.BLOCK_HINT_KEYS=["((","[[","（（","【【"],n.BLOCK_HINT_CLOSE_KEYS={"((":"))","[[":"]]","（（":"））","【【":"】】"},n.CODE_LANGUAGES=["js","ts","html","toml","c#","bat","bash","c","csharp","cpp","css","diff","go","xml","json","java","javascript","kotlin","less","lua","makefile","markdown","objectivec","php","php-template","perl","plaintext","python","python-repl","r","ruby","rust","scss","sql","shell","swift","ini","typescript","vbnet","yaml","properties","1c","armasm","avrasm","actionscript","ada","angelscript","accesslog","apache","applescript","arcade","arduino","asciidoc","aspectj","abnf","autohotkey","autoit","awk","basic","bnf","dos","brainfuck","cal","cmake","csp","cos","capnproto","ceylon","clean","clojure","clojure-repl","coffeescript","coq","crystal","d","dns","dart","delphi","dts","django","dockerfile","dust","erb","elixir","elm","erlang","erlang-repl","excel","ebnf","fsharp","fix","flix","fortran","gcode","gams","gauss","glsl","gml","gherkin","golo","gradle","groovy","haml","hsp","http","handlebars","haskell","haxe","hy","irpf90","isbl","inform7","x86asm","jboss-cli","julia","julia-repl","ldif","llvm","lsl","latex","lasso","leaf","lisp","livecodeserver","livescript","mel","mipsasm","matlab","maxima","mercury","axapta","routeros","mizar","mojolicious","monkey","moonscript","n1ql","nsis","nestedtext","nginx","nim","nix","node-repl","ocaml","openscad","ruleslanguage","oxygene","pf","parser3","pony","pgsql","powershell","processing","prolog","protobuf","puppet","purebasic","profile","q","qml","reasonml","rib","rsl","roboconf","sas","sml","sqf","step21","scala","scheme","scilab","smali","smalltalk","stan","stata","stylus","subunit","tp","taggerscript","tcl","tap","thrift","twig","vbscript","vbscript-html","vhdl","vala","verilog","vim","wasm","mathematica","wren","xl","xquery","zephir","crmsh","dsconfig","graphql","yul","solidity","abap"]},937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countBlockWord=t.countSelectWord=t.initStatus=void 0;t.initStatus=()=>{};t.countSelectWord=e=>{};t.countBlockWord=e=>{}},163:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.abcRender=void 0;const a=n(81),s=n(450);t.abcRender=(e,t=s.Constants.PROTYLE_CDN)=>{let n=[];n="abc"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="abc"]')),0!==n.length&&n.length>0&&(0,a.addScript)(`${t}/js/abcjs/abcjs-basic-min.js?v=0.0.0`,"protyleAbcjsScript").then((()=>{n.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>'),e.childElementCount<4&&e.lastElementChild.insertAdjacentHTML("beforebegin",`<span style="position: absolute">${s.Constants.ZWSP}</span>`);const t=e.firstElementChild.nextElementSibling;ABCJS.renderAbc(t,Lute.UnEscapeHTMLStr(e.getAttribute("data-content")),{responsive:"resize"}),t.setAttribute("contenteditable","false"),e.setAttribute("data-render","true")}))}))}},475:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.chartRender=void 0;const a=n(81),s=n(450),i=n(503);t.chartRender=(e,t=s.Constants.PROTYLE_CDN)=>{let n=[];n="echarts"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="echarts"]')),0!==n.length&&n.length>0&&(0,a.addScript)(`${t}/js/echarts/echarts.min.js?v=5.3.2`,"protyleEchartsScript").then((()=>{(0,a.addScript)(`${t}/js/echarts/echarts-gl.min.js?v=2.0.9`,"protyleEchartsGLScript").then((()=>{let e;if(0===n[0].firstElementChild.clientWidth){const t=(0,i.hasClosestByClassName)(n[0],"layout-tab-container",!0);t&&Array.from(t.children).find((t=>{if(t.classList.contains("protyle")&&!t.classList.contains("fn__none"))return e=t.querySelector(".protyle-wysiwyg").firstElementChild.clientWidth,!0}))}n.forEach((t=>{if("true"===t.getAttribute("data-render"))return;t.firstElementChild.classList.contains("protyle-icons")||t.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const n=t.firstElementChild.nextElementSibling;try{n.style.height=t.style.height;const a=JSON.parse(Lute.UnEscapeHTMLStr(t.getAttribute("data-content")));echarts.init(n,1===window.siyuan.config.appearance.mode?"dark":void 0,{width:e}).setOption(a),t.setAttribute("data-render","true"),n.classList.remove("ft__error"),n.textContent.endsWith(s.Constants.ZWSP)||n.firstElementChild.insertAdjacentText("beforeend",s.Constants.ZWSP)}catch(e){echarts.dispose(n),n.classList.add("ft__error"),n.innerHTML=`echarts render error: <br>${e}`}}))}))}))}},509:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.flowchartRender=void 0;const a=n(81),s=n(450),i=n(503);t.flowchartRender=(e,t=s.Constants.PROTYLE_CDN)=>{let n=[];n="flowchart"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="flowchart"]')),0!==n.length&&(0,a.addScript)(`${t}/js/flowchart.js/flowchart.min.js?v=0.0.0`,"protyleFlowchartScript").then((()=>{if(0===n[0].firstElementChild.clientWidth){const e=(0,i.hasClosestByClassName)(n[0],"protyle",!0);if(!e)return;const t=new MutationObserver((()=>{r(n),t.disconnect()}));t.observe(e,{attributeFilter:["class"]})}else r(n)}))};const r=e=>{e.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>'),e.childElementCount<4&&e.lastElementChild.insertAdjacentHTML("beforebegin",`<span style="position: absolute">${s.Constants.ZWSP}</span>`);const t=e.firstElementChild.nextElementSibling,n=flowchart.parse(Lute.UnEscapeHTMLStr(e.getAttribute("data-content")));t.innerHTML="";try{n.drawSVG(t)}catch(e){t.classList.add("ft__error"),t.innerHTML=`Flow Chart render error: <br>${e}`}t.setAttribute("contenteditable","false"),e.setAttribute("data-render","true")}))}},364:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.graphvizRender=void 0;const a=n(81),s=n(450);t.graphvizRender=(e,t=s.Constants.PROTYLE_CDN)=>{let n=[];n="graphviz"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="graphviz"]')),0!==n.length&&(0,a.addScript)(`${t}/js/graphviz/viz.js?v=0.0.0`,"protyleGraphVizScript").then((()=>{n.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const t=e.firstElementChild.nextElementSibling;try{const n=new Blob([`importScripts('${document.getElementById("protyleGraphVizScript").src.replace("viz.js","full.render.js")}');`],{type:"application/javascript"}),a=(window.URL||window.webkitURL).createObjectURL(n),i=new Worker(a);new Viz({worker:i}).renderSVGElement(Lute.UnEscapeHTMLStr(e.getAttribute("data-content"))).then((n=>{t.innerHTML=n.outerHTML,t.classList.remove("ft__error"),t.setAttribute("contenteditable","false"),e.textContent.endsWith(s.Constants.ZWSP)||e.insertAdjacentHTML("beforeend",`<span style="position: absolute">${s.Constants.ZWSP}</span>`)})).catch((e=>{t.innerHTML=`graphviz render error: <br>${e}`,t.classList.add("ft__error")}))}catch(e){console.error("Graphviz error",e)}e.setAttribute("data-render","true")}))}))}},631:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lineNumberRender=t.highlightRender=void 0;const a=n(81),s=n(719),i=n(450),r=n(246);t.highlightRender=(e,n=i.Constants.PROTYLE_CDN)=>{let o,l=!1;e.classList.contains("code-block")?o=e.querySelectorAll('[spellcheck="false"]'):e.classList.contains("item__readme")?(o=e.querySelectorAll("pre code"),o.forEach((e=>{e.parentElement.setAttribute("lineNumber","false")}))):e.classList.contains("b3-typography")?(o=e.querySelectorAll(".code-block code"),l=!0):o=e.querySelectorAll('.code-block [spellcheck="false"]'),0!==o.length&&((0,s.setCodeTheme)(n),(0,a.addScript)(`${n}/js/highlight.js/highlight.min.js?v=11.5.0`,"protyleHljsScript").then((()=>{(0,a.addScript)(`${n}/js/highlight.js/third-languages.js?v=1.0.0`,"protyleHljsThirdScript").then((()=>{o.forEach((e=>{var n;if("true"===e.getAttribute("data-render"))return;const a=e.querySelector("wbr");let s,i=0;if(a){let e=a.previousSibling;for(;e;){for(i+=e.textContent.length;!e.previousSibling&&"DIV"!==e.parentElement.tagName;)e=e.parentElement;e=e.previousSibling}a.remove()}s=l?e.parentElement.getAttribute("data-language"):e.previousElementSibling?e.previousElementSibling.firstElementChild.textContent:e.className.replace("language-",""),hljs.getLanguage(s)||(s="plaintext"),e.classList.add("hljs"),e.innerHTML=hljs.highlight(e.textContent+(e.textContent.endsWith("\n")?"":"\n"),{language:s,ignoreIllegals:!0}).value,e.setAttribute("data-render","true");const o=e.parentElement.getAttribute("linewrap"),c=e.parentElement.getAttribute("ligatures"),d=e.parentElement.getAttribute("linenumber");"true"===o||"false"!==o&&window.siyuan.config.editor.codeLineWrap?(e.style.setProperty("white-space","pre-wrap"),e.style.setProperty("word-break","break-all")):(e.style.setProperty("white-space","pre"),e.style.setProperty("word-break","initial")),"true"===c||"false"!==c&&window.siyuan.config.editor.codeLigatures?e.style.fontVariantLigatures="normal":e.style.fontVariantLigatures="none";const u=e.parentElement.querySelector(".protyle-action__language");!l&&("true"===d||"false"!==d&&window.siyuan.config.editor.codeSyntaxHighlightLineNum)?(e.classList.add("protyle-linenumber"),setTimeout((()=>{(0,t.lineNumberRender)(e)}),20),u&&(u.style.marginLeft="3.6em")):(null===(n=e.nextElementSibling)||void 0===n?void 0:n.classList.contains("protyle-linenumber__rows"))&&(e.classList.remove("protyle-linenumber"),e.nextElementSibling.remove(),u&&(u.style.marginLeft="")),a&&getSelection().rangeCount>0&&(0,r.focusByOffset)(e,i,i)}))}))})))};t.lineNumberRender=e=>{var t;if("false"===e.parentElement.getAttribute("lineNumber"))return;if(e.nextElementSibling&&e.nextElementSibling.clientHeight===e.clientHeight)return;e.classList.add("protyle-linenumber");const n=document.createElement("div");n.className="hljs protyle-linenumber",n.setAttribute("style",`padding-top:0 !important;padding-bottom:0 !important;min-height:auto !important;white-space:${e.style.whiteSpace};word-break:${e.style.wordBreak};font-variant-ligatures:${e.style.fontVariantLigatures};`),n.setAttribute("contenteditable","true"),e.insertAdjacentElement("afterend",n);let a="";const s=e.textContent.split(/\r\n|\r|\n|\u2028|\u2029/g);""===s[s.length-1]&&s.length>1&&s.pop();const i="break-all"===e.style.wordBreak;s.map((e=>{let t="";if(i){n.textContent=e||"\n";t=` style="height:${n.getBoundingClientRect().height}px;"`}a+=`<span${t}></span>`})),n.remove(),(null===(t=e.nextElementSibling)||void 0===t?void 0:t.classList.contains("protyle-linenumber__rows"))?e.nextElementSibling.innerHTML=a:e.insertAdjacentHTML("afterend",`<span contenteditable="false" class="protyle-linenumber__rows">${a}</span>`)}},430:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mathRender=void 0;const a=n(81),s=n(783),i=n(450),r=n(688),o=n(503);t.mathRender=(e,t=i.Constants.PROTYLE_CDN,n=!1)=>{let l=[];l="math"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="math"]')),0!==l.length&&((0,s.addStyle)(`${t}/js/katex/katex.min.css?v=0.16.0`,"protyleKatexStyle"),(0,a.addScript)(`${t}/js/katex/katex.min.js?v=0.16.0`,"protyleKatexScript").then((()=>{(0,a.addScript)(`${t}/js/katex/mhchem.min.js?v=0.16.0`,"protyleKatexMhchemScript").then((()=>{l.forEach((e=>{var t;if("true"===e.getAttribute("data-render"))return;e.setAttribute("data-render","true");let a=e;"DIV"===e.tagName&&(a=e.firstElementChild);let s={};try{s=JSON.parse(window.siyuan.config.editor.katexMacros||"{}")}catch(e){console.warn("KaTex macros is not JSON",e)}try{a.innerHTML=katex.renderToString(Lute.UnEscapeHTMLStr(e.getAttribute("data-content")),{displayMode:"DIV"===e.tagName,output:"html",macros:s}),a.classList.remove("ft__error");const l=(0,o.hasClosestBlock)(e);if("DIV"===e.tagName){a.firstElementChild.setAttribute("contenteditable","false"),a.childElementCount<2&&a.insertAdjacentHTML("beforeend",`<span style="position: absolute">${i.Constants.ZWSP}</span>`);const e=a.querySelectorAll(".base");e.length>0&&e[e.length-1].insertAdjacentHTML("afterend","<span class='fn__flex-1'></span>");const t=a.querySelector(".katex-html > .newline");t&&(t.parentElement.style.display="block")}else{l&&e.getBoundingClientRect().width>l.clientWidth?(e.style.maxWidth="100%",e.style.overflowX="auto",e.style.overflowY="hidden",e.style.display="inline-block"):(e.style.maxWidth="",e.style.overflowX="",e.style.overflowY="",e.style.display="");const n=(0,r.hasNextSibling)(e);n?n&&"\n"!==n.textContent&&n.textContent!==i.Constants.ZWSP&&e.insertAdjacentHTML("beforeend","&#xFEFF;"):"TH"!==e.parentElement.tagName&&"TD"!==e.parentElement.tagName?e.insertAdjacentText("afterend","\n"):e.insertAdjacentText("afterend",i.Constants.ZWSP),(null===(t=e.previousSibling)||void 0===t?void 0:t.textContent.endsWith("\n"))?e.insertAdjacentText("beforebegin",i.Constants.ZWSP):!(0,r.hasPreviousSibling)(e)&&["TH","TD"].includes(e.parentElement.tagName)&&e.insertAdjacentText("afterbegin",i.Constants.ZWSP)}n&&setTimeout((()=>{if("DIV"===e.tagName){const t=e.querySelector(".katex-display");t.clientWidth<t.scrollWidth&&t.firstElementChild.setAttribute("style",`font-size:${100*t.clientWidth/t.scrollWidth}%`)}else l&&e.offsetWidth>l.clientWidth&&e.firstElementChild.setAttribute("style",`font-size:${100*l.clientWidth/e.offsetWidth}%`)}))}catch(e){a.innerHTML=e.message,a.classList.add("ft__error")}}))}))})))}},272:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mediaRender=void 0;t.mediaRender=e=>{e&&e.querySelectorAll("a").forEach((e=>{const t=e.getAttribute("href");t&&(t.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?((e,t)=>{e.insertAdjacentHTML("afterend",`<video controls="controls" src="${t}"></video>`),e.remove()})(e,t):t.match(/^.+.(mp3|wav|flac)$/)?((e,t)=>{e.insertAdjacentHTML("afterend",`<audio controls="controls" src="${t}"></audio>`),e.remove()})(e,t):((e,t)=>{const n=t.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),a=t.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),s=t.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),i=t.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),r=t.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),o=t.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),l=t.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),c=t.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/),d=t.match(/(?:www\.|\/\/)asciinema\.org\/a\/(\w+)/);n&&11===n[1].length?(e.insertAdjacentHTML("afterend",`<iframe src="https://www.youtube.com/embed/${n[1]+(n[2]?"?start="+n[2]:"")}"></iframe>`),e.remove()):a&&a[1]?(e.insertAdjacentHTML("afterend",`<iframe src="https://player.youku.com/embed/${a[1]}"></iframe>`),e.remove()):s&&s[1]?(e.insertAdjacentHTML("afterend",`<iframe src="https://v.qq.com/txp/iframe/player.html?vid=${s[1]}"></iframe>`),e.remove()):i&&i[1]?(e.insertAdjacentHTML("afterend",`<iframe src="https://coub.com/embed/${i[1]}?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>`),e.remove()):r&&r[0]?(e.insertAdjacentHTML("afterend",`<iframe src="https://www.facebook.com/plugins/video.php?href=${encodeURIComponent(r[0])}"></iframe>`),e.remove()):o&&o[2]?(e.insertAdjacentHTML("afterend",`<iframe src="https://www.dailymotion.com/embed/video/${o[2]}"></iframe>`),e.remove()):l&&l[1]?(e.insertAdjacentHTML("afterend",`<iframe src="https://player.bilibili.com/player.html?bvid=${l[1]}"></iframe>`),e.remove()):c&&c[1]?(e.insertAdjacentHTML("afterend",`<iframe src="https://embed.ted.com/talks/${c[1]}"></iframe>`),e.remove()):d&&d[1]&&(e.insertAdjacentHTML("afterend",`<iframe style="height: 462px;width: 737px;min-width: auto;" src="https://asciinema.org/a/${d[1]}/embed?"></iframe>`),e.remove())})(e,t))}))}},608:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mermaidRender=void 0;const a=n(81),s=n(450),i=n(503);t.mermaidRender=(e,t=s.Constants.PROTYLE_CDN)=>{let n=[];n="mermaid"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="mermaid"]')),0!==n.length&&(0,a.addScript)(`${t}/js/mermaid/mermaid.min.js?v=9.1.1`,"protyleMermaidScript").then((()=>{const e={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8},gantt:{leftPadding:75,rightPadding:20}};if(1===window.siyuan.config.appearance.mode&&(e.theme="dark"),mermaid.initialize(e),0===n[0].firstElementChild.clientWidth){const e=(0,i.hasClosestByClassName)(n[0],"protyle",!0);if(!e)return;const t=new MutationObserver((()=>{r(n),t.disconnect()}));t.observe(e,{attributeFilter:["class"]})}else r(n)}))};const r=e=>{e.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const t=e.firstElementChild.nextElementSibling;t.removeAttribute("data-processed"),t.textContent=Lute.UnEscapeHTMLStr(e.getAttribute("data-content")),mermaid.init(void 0,t),e.setAttribute("data-render","true"),t.setAttribute("contenteditable","false"),e.textContent.endsWith(s.Constants.ZWSP)||e.insertAdjacentHTML("beforeend",`<span style="position: absolute">${s.Constants.ZWSP}</span>`)}))}},938:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mindmapRender=void 0;const a=n(81),s=n(450),i=n(503);t.mindmapRender=(e,t=s.Constants.PROTYLE_CDN)=>{let n=[];n="mindmap"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="mindmap"]')),0!==n.length&&(0,a.addScript)(`${t}/js/echarts/echarts.min.js?v=0.0.0`,"protyleEchartsScript").then((()=>{let e;if(0===n[0].firstElementChild.clientWidth){const t=(0,i.hasClosestByClassName)(n[0],"layout-tab-container",!0);t&&Array.from(t.children).find((t=>{if(t.classList.contains("protyle")&&!t.classList.contains("fn__none")&&t.querySelector(".protyle-wysiwyg").firstElementChild)return e=t.querySelector(".protyle-wysiwyg").firstElementChild.clientWidth,!0}))}n.forEach((t=>{if("true"===t.getAttribute("data-render"))return;t.firstElementChild.classList.contains("protyle-icons")||t.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const n=t.firstElementChild.nextElementSibling;try{n.style.height=t.style.height,echarts.init(n,1===window.siyuan.config.appearance.mode?"dark":void 0,{width:e}).setOption({series:[{data:[JSON.parse(Lute.EChartsMindmapStr(Lute.UnEscapeHTMLStr(t.getAttribute("data-content"))))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:(e,t)=>{var n;return(null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.children)?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"},backgroundColor:"transparent"}),t.setAttribute("data-render","true"),n.textContent.endsWith(s.Constants.ZWSP)||n.firstElementChild.insertAdjacentText("beforeend",s.Constants.ZWSP),n.classList.remove("ft__error")}catch(e){n.classList.add("ft__error"),n.innerHTML=`Mindmap render error: <br>${e}`}}))}))}},696:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.plantumlRender=void 0;const a=n(81),s=n(450);t.plantumlRender=(e,t=s.Constants.PROTYLE_CDN)=>{let n=[];n="plantuml"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="plantuml"]')),0!==n.length&&(0,a.addScript)(`${t}/js/plantuml/plantuml-encoder.min.js?v=0.0.0`,"protylePlantumlScript").then((()=>{n.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const t=e.firstElementChild.nextElementSibling;try{t.innerHTML=`<img src=${window.siyuan.config.editor.plantUMLServePath}${plantumlEncoder.encode(Lute.UnEscapeHTMLStr(e.getAttribute("data-content")))}">`,t.classList.remove("ft__error"),e.setAttribute("data-render","true")}catch(e){t.classList.add("ft__error"),t.innerHTML=`plantuml render error: <br>${e}`}}))}))}},719:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setCodeTheme=void 0;const a=n(450),s=n(783);t.setCodeTheme=(e=a.Constants.PROTYLE_CDN)=>{const t=document.getElementById("protyleHljsStyle");let n;0===window.siyuan.config.appearance.mode?(n=window.siyuan.config.appearance.codeBlockThemeLight,a.Constants.SIYUAN_CONFIG_APPEARANCE_LIGHT_CODE.includes(n)||(n="default")):(n=window.siyuan.config.appearance.codeBlockThemeDark,a.Constants.SIYUAN_CONFIG_APPEARANCE_DARK_CODE.includes(n)||(n="github-dark"));const i=`${e}/js/highlight.js/styles/${n}.min.css?v=11.5.0`;t?t.href.includes(i)||(t.remove(),(0,s.addStyle)(i,"protyleHljsStyle")):(0,s.addStyle)(i,"protyleHljsStyle")}},81:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addScript=t.addScriptSync=void 0;t.addScriptSync=(e,t)=>{if(document.getElementById(t))return!1;const n=new XMLHttpRequest;n.open("GET",e,!1),n.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),n.send("");const a=document.createElement("script");a.type="text/javascript",a.text=n.responseText,a.id=t,document.head.appendChild(a)};t.addScript=(e,t)=>new Promise((n=>{if(document.getElementById(t))return n(!1),!1;const a=document.createElement("script");a.src=e,a.async=!0,document.head.appendChild(a),a.onload=()=>{if(document.getElementById(t))return a.remove(),n(!1),!1;a.id=t,n(!0)}}))},783:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addStyle=void 0;t.addStyle=(e,t)=>{if(!document.getElementById(t)){const n=document.createElement("link");n.id=t,n.rel="stylesheet",n.type="text/css",n.href=e,document.getElementsByTagName("head")[0].appendChild(n)}}},503:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasClosestByClassName=t.hasClosestByMatchTag=t.hasClosestBlock=t.hasClosestByAttribute=t.hasTopClosestByAttribute=t.hasTopClosestByTag=t.hasTopClosestByClassName=t.hasClosestByTag=void 0;t.hasClosestByTag=(e,t)=>{if(!e)return!1;3===e.nodeType&&(e=e.parentElement);let n=e,a=!1;for(;n&&!a&&!n.classList.contains("b3-typography");)0===n.nodeName.indexOf(t)?a=!0:n=n.parentElement;return a&&n};t.hasTopClosestByClassName=(e,n,a=!1)=>{let s=(0,t.hasClosestByClassName)(e,n,a),i=!1,r=!1;for(;s&&(a?"BODY"!==s.tagName:!s.classList.contains("protyle-wysiwyg"))&&!r;)i=(0,t.hasClosestByClassName)(s.parentElement,n,a),i?s=i:r=!0;return s||!1};t.hasTopClosestByTag=(e,n)=>{let a=(0,t.hasClosestByTag)(e,n),s=!1,i=!1;for(;a&&!a.classList.contains("protyle-wysiwyg")&&!i;)s=(0,t.hasClosestByTag)(a.parentElement,n),s?a=s:i=!0;return a||!1};t.hasTopClosestByAttribute=(e,n,a,s=!1)=>{let i=(0,t.hasClosestByAttribute)(e,n,a,s),r=!1,o=!1;for(;i&&!i.classList.contains("protyle-wysiwyg")&&!o;)r=(0,t.hasClosestByAttribute)(i.parentElement,n,a,s),r?i=r:o=!0;return i||!1};t.hasClosestByAttribute=(e,t,n,a=!1)=>{var s;if(!e)return!1;3===e.nodeType&&(e=e.parentElement);let i=e,r=!1;for(;i&&!r&&(a?"BODY"!==i.tagName:!i.classList.contains("protyle-wysiwyg"));)"string"==typeof n&&(null===(s=i.getAttribute(t))||void 0===s?void 0:s.split(" ").includes(n))||"string"!=typeof n&&i.hasAttribute(t)?r=!0:i=i.parentElement;return r&&i};t.hasClosestBlock=e=>{var n;const a=(0,t.hasClosestByAttribute)(e,"data-node-id",null);return!(!a||"BUTTON"===a.tagName||!(null===(n=a.getAttribute("data-type"))||void 0===n?void 0:n.startsWith("Node")))&&a};t.hasClosestByMatchTag=(e,t)=>{if(!e)return!1;3===e.nodeType&&(e=e.parentElement);let n=e,a=!1;for(;n&&!a&&!n.classList.contains("protyle-wysiwyg");)n.nodeName===t?a=!0:n=n.parentElement;return a&&n};t.hasClosestByClassName=(e,t,n=!1)=>{if(!e)return!1;3===e.nodeType&&(e=e.parentElement);let a=e,s=!1;for(;a&&!s&&(n?"BODY"!==a.tagName:!a.classList.contains("protyle-wysiwyg"));)a.classList.contains(t)?s=!0:a=a.parentElement;return s&&a}},246:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.focusSideBlock=t.focusBlock=t.focusByRange=t.focusByWbr=t.focusByOffset=t.setFirstNodeRange=t.setLastNodeRange=t.getSelectionOffset=t.getSelectionPosition=t.getEditorRange=t.selectAll=t.fixTableRange=void 0;const a=n(688),s=n(503),i=n(937);t.fixTableRange=e=>{const t=(0,s.hasClosestByAttribute)(e.startContainer,"data-type","NodeTable");if(""!==e.toString()&&t&&3!==e.commonAncestorContainer.nodeType){const n=e.commonAncestorContainer.tagName;if("TH"!==n&&"TD"!==n){const n=(0,s.hasClosestByMatchTag)(e.startContainer,"TD")||(0,s.hasClosestByMatchTag)(e.startContainer,"TH"),a=(0,s.hasClosestByMatchTag)(e.endContainer,"TD")||(0,s.hasClosestByMatchTag)(e.endContainer,"TH");if(n||a){if(n&&!n.contains(e.endContainer)){const t=e.cloneRange();e.setEnd(n.lastChild,n.lastChild.textContent.length),""===e.toString()&&a&&(e.setStart(a.firstChild,0),e.setEnd(t.endContainer,t.endOffset))}}else{const n=t.querySelector("th")||t.querySelector("td");e.setStart(n.firstChild,0),e.setEnd(n.lastChild,n.lastChild.textContent.length)}}}};t.selectAll=(e,n,r)=>{const o=(0,a.getContenteditableElement)(n);if(o){let a;if("TABLE"===o.tagName){const o=(0,s.hasClosestByMatchTag)(r.startContainer,"TD")||(0,s.hasClosestByMatchTag)(r.startContainer,"TH");if(o&&(a=(0,t.getSelectionOffset)(o,n,r),0!==a.start||a.end!==o.textContent.length))return r.setStart(o.firstChild,0),r.setEndAfter(o.lastChild),e.toolbar.render(e,r),(0,i.countSelectWord)(r),!0}else if(a=(0,t.getSelectionOffset)(o,n,r),0!==a.start||a.end!==o.textContent.length){let t=o.firstChild;for(;t;)if(3===t.nodeType){if(""!==t.textContent){r.setStart(t,0);break}t=t.nextSibling}else{if(t.classList.contains("render-node")||t.classList.contains("img")){r.setStartBefore(t);break}t=t.firstChild}let n=o.lastChild;for(;n;)if(3===n.nodeType){if(""!==n.textContent){r.setEnd(n,n.textContent.length);break}n=n.previousSibling}else{if(n.classList.contains("render-node")||n.classList.contains("img")||"BR"===n.tagName){r.setEndAfter(n);break}n=n.lastChild}return e.toolbar.render(e,r),(0,i.countSelectWord)(r),!0}}r.collapse(!0);const l=e.wysiwyg.element.querySelectorAll(".protyle-wysiwyg--select");if(e.wysiwyg.element.childElementCount===l.length&&l[0].parentElement.isSameNode(e.wysiwyg.element))return!0;l.forEach((e=>{e.classList.remove("protyle-wysiwyg--select")}));const c=[];Array.from(e.wysiwyg.element.children).forEach((e=>{e.classList.add("protyle-wysiwyg--select"),c.push(e.getAttribute("data-node-id"))})),(0,i.countBlockWord)(c)};t.getEditorRange=e=>{let t,n;return getSelection().rangeCount>0&&(t=getSelection().getRangeAt(0),e.isSameNode(t.startContainer)||e.contains(t.startContainer))||(e.focus({preventScroll:!0}),e.classList.contains("table")?n=e.querySelector("th")||e.querySelector("td"):(n=(0,a.getContenteditableElement)(e),n?"TABLE"===n.tagName&&(n=n.querySelector("th")||e.querySelector("td")):n=e),t=n.ownerDocument.createRange(),t.setStart(n||e,0),t.collapse(!0)),t};t.getSelectionPosition=(e,n)=>{if(n||(n=(0,t.getEditorRange)(e)),!e.contains(n.startContainer))return{left:0,top:0};let a;if(0===n.getClientRects().length)if(3===n.startContainer.nodeType){const e=n.startContainer.parentElement;if(!(e&&e.getClientRects().length>0))return{left:0,top:0};a=e.getClientRects()[0]}else{const e=n.startContainer.children;if(e[n.startOffset]&&e[n.startOffset].getClientRects().length>0)a=e[n.startOffset].getClientRects()[0];else if(n.startContainer.childNodes.length>0){const e=n.cloneRange();n.selectNode(n.startContainer.childNodes[Math.max(0,n.startOffset-1)]),a=n.getClientRects()[0],n.setEnd(e.endContainer,e.endOffset),n.setStart(e.startContainer,e.startOffset)}else a=n.startContainer.getClientRects()[0];if(!a){let e=n.startContainer.childNodes[n.startOffset];for(e||(e=n.startContainer.childNodes[n.startOffset-1]);!e.getClientRects||e.getClientRects&&0===e.getClientRects().length;)e=e.parentElement;a=e.getClientRects()[0]}}else a=n.getBoundingClientRect();return{left:a.left,top:a.top}};function r(e,t,n,a){if(!t)return!1;if(n(t))return!0;for(let e=0,a=t.childNodes.length;e<a;e++)if(r(t,t.childNodes[e],n,!0))return!0;if(!a){let a=t;for(;a&&a!==e;){let t=a.nextSibling;for(;t;){if(r(e,t,n,!0))return!0;t=t.nextSibling}a=a.parentNode}}return!1}t.getSelectionOffset=(e,t,n)=>{const a={end:0,start:0};if(!n){if(0===getSelection().rangeCount)return a;n=window.getSelection().getRangeAt(0)}if(t&&!((e,t)=>{if(!t){if(0===getSelection().rangeCount)return!1;t=getSelection().getRangeAt(0)}const n=t.commonAncestorContainer;return e.isEqualNode(n)||e.contains(n)})(t,n))return a;const s=n.cloneRange();return e.childNodes[0]&&e.childNodes[0].childNodes[0]?s.setStart(e.childNodes[0].childNodes[0],0):s.selectNodeContents(e),s.setEnd(n.startContainer,n.startOffset),a.start=s.toString().length,a.end=a.start+n.toString().length,a};t.setLastNodeRange=(e,t,n=!0)=>{if(!e)return t;let a=e.lastChild;for(;a&&3!==a.nodeType;)a=a.lastChild;return a?(n?t.setStart(a,a.textContent.length):t.setEnd(a,a.textContent.length),t):(t.selectNodeContents(e),t)};t.setFirstNodeRange=(e,t)=>{if(!e)return t;let n=e.firstChild;for(;n&&3!==n.nodeType;)n=n.firstChild;return n?(t.setStart(n,0),t):(t.selectNodeContents(e),t)};t.focusByOffset=(e,n,s)=>{if(!e)return!1;const i=(0,a.getContenteditableElement)(e);if(i)e=i;else if((0,a.isNotEditBlock)(e))return(0,t.focusBlock)(e);let o,l;r(e,e.firstChild,(e=>{if(e.nodeType===Node.TEXT_NODE){const t=e.data.length;return n<=t?(o=e,!0):(n-=t,s-=t,!1)}})),o&&r(e,o,(e=>{if(e.nodeType===Node.TEXT_NODE){const t=e.data.length;return s<=t?(l=e,!0):(s-=t,!1)}}));const c=document.createRange();return o?n<o.data.length?c.setStart(o,n):c.setStartAfter(o):0===n?c.setStart(e,0):(0,t.setLastNodeRange)((0,a.getContenteditableElement)(e),c),l?s<l.data.length?c.setEnd(l,s):c.setEndAfter(l):0===s?c.setEnd(e,0):(0,t.setLastNodeRange)((0,a.getContenteditableElement)(e),c,!1),(0,t.focusByRange)(c),c};t.focusByWbr=(e,n)=>{var s;const i=e.querySelectorAll("wbr");if(0===i.length)return;i.forEach(((e,t)=>{0!==t&&e.remove()}));const r=i[0];if(r.previousElementSibling){const e=(0,a.hasPreviousSibling)(r);e&&r.previousElementSibling.isSameNode(e)?3===(null===(s=r.previousElementSibling.lastChild)||void 0===s?void 0:s.nodeType)?n.setStart(r.previousElementSibling.lastChild,r.previousElementSibling.lastChild.textContent.length):3!==e.nodeType&&e.classList.contains("img")?n.setStartAfter(e):n.setStartBefore(r):n.setStart(r.previousSibling,r.previousSibling.textContent.length)}else r.previousSibling?n.setStart(r.previousSibling,r.previousSibling.textContent.length):r.nextSibling?3===r.nextSibling.nodeType?n.setStart(r.nextSibling,0):n.setStartAfter(r):n.setStart(r.parentElement,0);n.collapse(!0),r.remove(),(0,t.focusByRange)(n)};t.focusByRange=e=>{if(!e)return;const t=window.getSelection();t.removeAllRanges(),t.addRange(e)};t.focusBlock=(e,n,s=!0)=>{var i,r,o;if(!e)return!1;if(e.classList.contains("render-node")||e.classList.contains("iframe")||e.classList.contains("hr")){const n=document.createRange(),a=e.getAttribute("data-type");let s=!1;return"NodeThematicBreak"===a?(n.selectNodeContents(e.firstElementChild),s=!0):"NodeBlockQueryEmbed"===a?((null===(i=e.lastElementChild.previousElementSibling)||void 0===i?void 0:i.firstChild)?(n.selectNodeContents(e.lastElementChild.previousElementSibling.firstChild),n.collapse(!0)):(n.selectNodeContents(e),n.collapse(!0)),s=!0):["NodeMathBlock","NodeHTMLBlock"].includes(a)?((null===(o=null===(r=e.lastElementChild.previousElementSibling)||void 0===r?void 0:r.lastElementChild)||void 0===o?void 0:o.firstChild)?(n.selectNodeContents(e.lastElementChild.previousElementSibling.lastElementChild.firstChild),n.collapse(!0)):e.lastElementChild.previousElementSibling&&(n.selectNodeContents(e.lastElementChild.previousElementSibling),n.collapse(!0)),s=!0):"NodeIFrame"===a||"NodeWidget"===a?(n.setStart(e,0),s=!0):"NodeVideo"===a?(n.setStart(e.firstElementChild,0),s=!0):"NodeAudio"===a?(n.setStart(e.firstElementChild.lastChild,0),s=!0):"NodeCodeBlock"===a&&(n.selectNodeContents(e),n.collapse(!0),s=!0),s?((0,t.focusByRange)(n),n):((0,t.focusSideBlock)(e),!1)}let l;if(s?l=(0,a.getContenteditableElement)(e):Array.from(e.querySelectorAll('[contenteditable="true"]')).reverse().find((e=>{if(e.getBoundingClientRect().width>0)return l=e,!0})),l){if("TABLE"===l.tagName)if(s)l=l.querySelector("th, td");else{const e=l.querySelectorAll("th, td");l=e[e.length-1]}const e=(0,t.getEditorRange)(l);return e.selectNodeContents(l),e.collapse(s),(0,t.focusByRange)(e),e}return n&&n.focus(),!1};t.focusSideBlock=e=>{if(e.getAttribute("data-node-id")){let n,s;return e.nextElementSibling&&!e.nextElementSibling.classList.contains("protyle-attr")?(s=!0,n=(0,a.getNextBlock)(e)):e.previousElementSibling&&(s=!1,n=(0,a.getPreviousBlock)(e)),n||(n=e),void(0,t.focusBlock)(n,void 0,s)}const n=(0,t.getEditorRange)(e);e.nextSibling?(n.selectNodeContents(e.nextSibling),n.collapse(!0)):e.previousSibling&&(n.selectNodeContents(e.previousSibling),n.collapse(!1)),(0,t.focusByRange)(n)}},688:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasPreviousSibling=t.hasNextSibling=t.getTopAloneElement=t.getTopEmptyElement=t.isNotEditBlock=t.getContenteditableElement=t.getNoContainerElement=t.getNextBlock=t.getFirstBlock=t.getLastBlock=t.getPreviousBlock=t.getPreviousHeading=void 0;const a=n(503);t.getPreviousHeading=e=>{let n=(0,t.getPreviousBlock)(e);for(;n&&"NodeHeading"!==n.getAttribute("data-type");)n=(0,t.getPreviousBlock)(n);return n};t.getPreviousBlock=e=>{let t=e;for(;t;){if(t.previousElementSibling&&t.previousElementSibling.getAttribute("data-node-id"))return t.previousElementSibling;const e=(0,a.hasClosestBlock)(t.parentElement);if(!e)return!1;t=e}};t.getLastBlock=e=>{let t;return Array.from(e.querySelectorAll("[data-node-id]")).reverse().find((e=>{if(!(0,a.hasClosestByAttribute)(e.parentElement,"data-type","NodeBlockQueryEmbed"))return t=e,!0})),t||e};t.getFirstBlock=e=>{let t;return Array.from(e.querySelectorAll("[data-node-id]")).find((e=>{if(!(0,a.hasClosestByAttribute)(e.parentElement,"data-type","NodeBlockQueryEmbed")&&!e.classList.contains("li"))return t=e,!0})),t||e};t.getNextBlock=e=>{let t=e;for(;t;){if(t.nextElementSibling&&!t.nextElementSibling.classList.contains("protyle-attr"))return t.nextElementSibling;const e=(0,a.hasClosestBlock)(t.parentElement);if(!e)return!1;t=e}return!1};t.getNoContainerElement=e=>{let t=e;for(;t;){if(!(t.classList.contains("list")||t.classList.contains("li")||t.classList.contains("bq")||t.classList.contains("sb")))return t;t=t.querySelector("[data-node-id]")}return!1};t.getContenteditableElement=e=>!e||"true"===e.getAttribute("contenteditable")&&!e.classList.contains("protyle-wysiwyg")?e:e.querySelector('[contenteditable="true"]');t.isNotEditBlock=e=>["NodeBlockQueryEmbed","NodeThematicBreak","NodeMathBlock","NodeHTMLBlock","NodeIFrame","NodeWidget","NodeVideo","NodeAudio"].includes(e.getAttribute("data-type"))||"NodeCodeBlock"===e.getAttribute("data-type")&&e.classList.contains("render-node");t.getTopEmptyElement=e=>{var n;let a=e;for(;a.parentElement&&!a.parentElement.classList.contains("protyle-wysiwyg");)if(a.parentElement.getAttribute("data-node-id")){if(""!==(0,t.getContenteditableElement)(a.parentElement).textContent||(null===(n=a.previousElementSibling)||void 0===n?void 0:n.getAttribute("data-node-id")))break;a=a.parentElement}else a=a.parentElement;return a};t.getTopAloneElement=e=>{if("NodeBlockquote"===e.parentElement.getAttribute("data-type")&&2===e.parentElement.childElementCount)for(;!e.parentElement.classList.contains("protyle-wysiwyg");){if("NodeBlockquote"!==e.parentElement.getAttribute("data-type")||2!==e.parentElement.childElementCount){e=(0,t.getTopAloneElement)(e);break}e=e.parentElement}else if("NodeSuperBlock"===e.parentElement.getAttribute("data-type")&&2===e.parentElement.childElementCount)for(;!e.parentElement.classList.contains("protyle-wysiwyg");){if("NodeSuperBlock"!==e.parentElement.getAttribute("data-type")||2!==e.parentElement.childElementCount){e=(0,t.getTopAloneElement)(e);break}e=e.parentElement}else if("NodeListItem"===e.parentElement.getAttribute("data-type")&&3===e.parentElement.childElementCount)for(;!e.parentElement.classList.contains("protyle-wysiwyg");)if("NodeListItem"===e.parentElement.getAttribute("data-type")&&3===e.parentElement.childElementCount)e=e.parentElement;else{if("NodeList"!==e.parentElement.getAttribute("data-type")||2!==e.parentElement.childElementCount){e=(0,t.getTopAloneElement)(e);break}e=e.parentElement}else if("NodeList"===e.parentElement.getAttribute("data-type")&&2===e.parentElement.childElementCount)for(;!e.parentElement.classList.contains("protyle-wysiwyg");)if("NodeList"===e.parentElement.getAttribute("data-type")&&2===e.parentElement.childElementCount)e=e.parentElement;else{if("NodeListItem"!==e.parentElement.getAttribute("data-type")||3!==e.parentElement.childElementCount){e=(0,t.getTopAloneElement)(e);break}e=e.parentElement}return e};t.hasNextSibling=e=>{let t=e.nextSibling;for(;t;){if(""!==t.textContent)return t;t=t.nextSibling}return!1};t.hasPreviousSibling=e=>{let t=e.previousSibling;for(;t;){if(""!==t.textContent||3!==t.nodeType)return t;t=t.previousSibling}return!1}}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{var e=a;const t=n(364),s=n(631),i=n(430),r=n(608),o=n(509),l=n(475),c=n(163),d=n(938),u=n(272),m=n(696);n(378);class p{}p.graphvizRender=t.graphvizRender,p.highlightRender=s.highlightRender,p.mathRender=i.mathRender,p.mermaidRender=r.mermaidRender,p.flowchartRender=o.flowchartRender,p.chartRender=l.chartRender,p.abcRender=c.abcRender,p.mindmapRender=d.mindmapRender,p.plantumlRender=m.plantumlRender,p.mediaRender=u.mediaRender,e.default=p})(),a=a.default})()));